# Семинар 4. Нейросетевой рекомендер

На этом семинаре мы поэкспериментируем с нейросетевым рекомендером, реализованным на torch.
Рекомендер будет предсказывать время проигрывания трека по первому треку в сессии (считаем, что
именно первый терк несет в себе больше всего информации, так как отражает настроение пользователя).

### План действий

1.  Используем ноутбук `Week4SeminarModel.ipynb`, для того, чтобы собрать данные для обучения рекомендера
    1. Формируем пары первый трек - текущий трек и записываем время прослушивания как таргет
    2. Делим сохраненные в предыдущем пункте данные на train-test-val
    3. Реализуем на torch модель, предсказывающую время прослушки
    4. Обучаем модель
    5. Выгружаем top-10 соседей для каждого трека и добавляем в данные треков
    
2. Реализуем новый рекомендер `Contextual`, который будет выдавать следующий рекомендованный трек, если дан предыдущий
    1. Загружаем рекомендации в базу треков в `Redis`
    2. При запросе ищем в базе предыдущий трек и достаем рекомендованные для него
    3. Если рекомендаций не нашлось, то возвращаем случайные
    
3. Создаем A/B эксперимент.
    1. В `botify.experiment.Experiments` создаем эксперимент `RECOMMENDERS`.
    2. В `botify.server.NextTrack` используем этот эксперимент для выбора рекомендера.
       В этом эксперименте будут участвовать все реализованные рекомендеры.
    3. Запускаем рекомендер и симулятор.
    4. Загружаем логи сервиса на HDFS.
   
4. Используем ноутбук `Week1Seminar.ipynb` для анализа.
    1. Запускаем анализатор для эксперимента `RECOMMENDERS`.
    
### Вопросы

1. Какие есть варианты реализации на проде доставания следющего трека по эмбеддингу предыдущего?
2. Как улучшить нейросетевой рекомендер? Какие признаки можно добавить?
3. Как скомбинировать нейросетевой рекомендер и lightfm из предыдущего семинара для реализации двухступенчатой модели?

### Задачки

#### LightFM -> torch

Какая нейросетевая архитектура соответствует модели lightFM?